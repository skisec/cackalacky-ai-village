# Ollama Embedding Classifier

This project implements a text classification system using embeddings generated by Ollama models. It provides a Gradio-based user interface for interactive classification of text into user-defined categories.

## Features

- Use Ollama models for text embedding generation
- Create and manage custom categories with example texts
- Classify input text against defined categories
- Interactive web interface using Gradio

## Requirements

- Python 3.12
- Ollama installed and running on your system
- Required Python packages (install using `pip install -r requirements.txt`):
  - requests
  - numpy
  - gradio
  - scikit-learn

## How to Run

1. Ensure Ollama is installed and running on your system with the command: `ollama serve`
2. Install embedding models: 

    ```bash
    ollama pull nomic-embed-text
    ollama pull mxbai-embed-large
    ollama pull snowflake-arctic-embed
    ```

3. Install the required Python packages: `pip install -r requirements.txt`
4. Run the script: `python embeddings_classification.py`
5. Open the provided URL in your web browser to access the Gradio interface.

## Code Explanation

### Main Components

1. `EmbeddingClassifier` class:
   - Manages categories and their embeddings
   - Handles text classification using cosine similarity

2. `create_ui()` function:
   - Sets up the Gradio interface for user interaction

3. `get_available_models()` function:
   - Retrieves available embedding models from Ollama

### How it Works

1. **Embedding Generation**:
   - The `get_embedding()` method in `EmbeddingClassifier` sends a request to the Ollama API to generate embeddings for given text.

2. **Category Management**:
   - Users can add categories with example texts through the UI.
   - The `add_category()` method creates embeddings for examples and stores the average embedding for each category.

3. **Classification Process**:
   - When classifying text, the system generates an embedding for the input text.
   - It then calculates the cosine similarity between the input embedding and each category's embedding.
   - Results are sorted by similarity score, providing a ranked list of matching categories.

4. **Model Selection**:
   - The UI allows users to select from available Ollama embedding models.
   - The `get_available_models()` function fetches and filters models from Ollama, preferring those likely to be suitable for embeddings.

5. **Error Handling**:
   - The code includes error handling for API requests and edge cases (e.g., no categories defined, empty input text).

## Why This Approach

- **Flexibility**: Users can define custom categories, making the system adaptable to various classification tasks.
- **Efficiency**: Embeddings provide a compact representation of text, enabling fast similarity comparisons.
- **Ease of Use**: The Gradio interface makes it simple for users to interact with the system without needing to understand the underlying code.
- **Integration with Ollama**: Leverages Ollama's capabilities for embedding generation, allowing use of various pre-trained models.

## Limitations and Considerations

- The accuracy of classification depends on the quality of example texts and the chosen embedding model.
- The system uses a simple averaging of example embeddings for each category, which may not be optimal for all use cases.
- The method of filtering for embedding models is approximate and may need adjustment based on Ollama's model naming conventions.

## Future Improvements

- Implement more sophisticated methods for category representation (e.g., clustering of example embeddings).
- Add options for fine-tuning or customizing embedding models.
- Expand error handling and provide more detailed feedback to users.