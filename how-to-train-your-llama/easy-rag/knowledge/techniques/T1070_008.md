# Clear Mailbox Data (T1070.008)

## Description
Adversaries may modify mail and mail application data to remove evidence of their activity. Email applications allow users and other programs to export and delete mailbox data via command line tools or use of APIs. Mail application data can be emails, email metadata, or logs generated by the application or operating system, such as export requests. 

Adversaries may manipulate emails and mailbox data to remove logs, artifacts, and metadata, such as evidence of Phishing (T1566)/Internal Spearphishing (T1534), Email Collection (T1114), Mail Protocols (T1071.003) for command and control, or email-based exfiltration such as Exfiltration Over Alternative Protocol (T1048). For example, to remove evidence on Exchange servers adversaries have used the ```ExchangePowerShell``` PowerShell (T1059.001) module, including ```Remove-MailboxExportRequest``` to remove evidence of mailbox exports. On Linux and macOS, adversaries may also delete emails through a command line utility called ```mail```  or use AppleScript (T1059.002) to interact with APIs on macOS.

Adversaries may also remove emails and metadata/headers indicative of spam or suspicious activity (for example, through the use of organization-wide transport rules) to reduce the likelihood of malicious emails being detected by security products.

## Parent Technique
- Indicator Removal (T1070)

## Tactics
- Defense Evasion (TA0005)

## Related Groups
- APT42 (G1044)

## Mitigations
- Restrict File and Directory Permissions (M1022)
- Audit (M1047)
- Remote Data Storage (M1029)

## Detection

### Detailed Detection by Data Source/Component
#### Application Log: Application Log Content (DS0015): 
In environments using Exchange, monitor logs for the creation or modification of mail processing settings, such as transport rules.

#### File: File Deletion (DS0022): 
Monitor for deletion of generated artifacts on a host system, including logs or captured files such as quarantined emails. 

On Windows 10, mail application data is stored in ```C:\Users\Username\AppData\Local\Comms\Unistore\data```. On Linux, mail data is stored in ```/var/spool/mail``` or ```/var/mail```. On macOS, mail data is stored in ```~/Library/Mail```.

#### File: File Modification (DS0022): 
Monitor for changes made to generated artifacts on a host system, including logs or captured files such as quarantined emails. 

On Windows 10, mail application data is stored in ```C:\Users\Username\AppData\Local\Comms\Unistore\data```. On Linux, mail data is stored in ```/var/spool/mail``` or ```/var/mail```. On macOS, mail data is stored in ```~/Library/Mail```.

#### Command: Command Execution (DS0017): 
Monitor executed commands and arguments that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined emails. In Exchange environments, monitor for PowerShell cmdlets that may create or alter transport rules, such as `New-TransportRule` and `Set-TransportRule`.

#### Process: Process Creation (DS0009): 
Monitor for newly executed processes with arguments that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined emails.

